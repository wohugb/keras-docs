



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Keras，Python 深度学习库中文文档。">
      
      
        <link rel="canonical" href="http://keras.io/zh/4.examples/deep_dream/">
      
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="ja">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.0">
    
    
      
        <title>Deep dream - Keras 中文文档</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#ef5350">
      
    
    
      <script src="../../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-61785484-1", "keras.io")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="red" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://keras.io/zh/" title="Keras 中文文档" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Keras 中文文档
            </span>
            <span class="md-header-nav__topic">
              Deep dream
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/wohugb/keras-docs/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." title="Keras 文档" class="md-tabs__link">
        Keras 文档
      </a>
    
  </li>

      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../0.getting-started/0.sequential-model-guide/" title="0.getting started" class="md-tabs__link">
          0.getting started
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../1.models/0.about-keras-models/" title="1.models" class="md-tabs__link">
          1.models
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../2.layers/0.about-keras-layers/" title="2.layers" class="md-tabs__link">
          2.layers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../3.preprocessing/0.sequence/" title="3.preprocessing" class="md-tabs__link">
          3.preprocessing
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="4.examples" class="md-tabs__link md-tabs__link--active">
          4.examples
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://keras.io/zh/" title="Keras 中文文档" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Keras 中文文档
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/wohugb/keras-docs/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Keras 文档" class="md-nav__link">
      Keras 文档
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../activations/" title="Activations" class="md-nav__link">
      Activations
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../applications/" title="应用 Applications" class="md-nav__link">
      应用 Applications
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../backend/" title="Keras 后端" class="md-nav__link">
      Keras 后端
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../callbacks/" title="Callbacks" class="md-nav__link">
      Callbacks
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../constraints/" title="Constraints" class="md-nav__link">
      Constraints
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../contributing/" title="关于 Github Issues 和 Pull Requests" class="md-nav__link">
      关于 Github Issues 和 Pull Requests
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../datasets/" title="数据集" class="md-nav__link">
      数据集
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../initializers/" title="Initializers" class="md-nav__link">
      Initializers
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../losses/" title="Losses" class="md-nav__link">
      Losses
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../metrics/" title="Metrics" class="md-nav__link">
      Metrics
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../optimizers/" title="Optimizers" class="md-nav__link">
      Optimizers
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../regularizers/" title="Regularizers" class="md-nav__link">
      Regularizers
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../scikit-learn-api/" title="Scikit-Learn API 的封装器" class="md-nav__link">
      Scikit-Learn API 的封装器
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../utils/" title="Utils" class="md-nav__link">
      Utils
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../visualization/" title="Visualization" class="md-nav__link">
      Visualization
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../why-use-keras/" title="为什么选择 Keras？" class="md-nav__link">
      为什么选择 Keras？
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-18" type="checkbox" id="nav-18">
    
    <label class="md-nav__link" for="nav-18">
      0.getting started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-18">
        0.getting started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../0.getting-started/0.sequential-model-guide/" title="开始使用 Keras Sequential 顺序模型" class="md-nav__link">
      开始使用 Keras Sequential 顺序模型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../0.getting-started/1.functional-api-guide/" title="开始使用 Keras 函数式 API" class="md-nav__link">
      开始使用 Keras 函数式 API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../0.getting-started/2.faq/" title="Keras FAQ: 常见问题解答" class="md-nav__link">
      Keras FAQ: 常见问题解答
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-19" type="checkbox" id="nav-19">
    
    <label class="md-nav__link" for="nav-19">
      1.models
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-19">
        1.models
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../1.models/0.about-keras-models/" title="关于 Keras 模型" class="md-nav__link">
      关于 Keras 模型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../1.models/1.sequential/" title="Sequential 模型 API" class="md-nav__link">
      Sequential 模型 API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../1.models/2.model/" title="Model 类（函数式 API）" class="md-nav__link">
      Model 类（函数式 API）
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-20" type="checkbox" id="nav-20">
    
    <label class="md-nav__link" for="nav-20">
      2.layers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-20">
        2.layers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../2.layers/0.about-keras-layers/" title="关于 Keras 网络层" class="md-nav__link">
      关于 Keras 网络层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2.layers/1.core/" title="核心网络层" class="md-nav__link">
      核心网络层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2.layers/2.convolutional/" title="卷积层" class="md-nav__link">
      卷积层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2.layers/3.pooling/" title="池化层" class="md-nav__link">
      池化层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2.layers/4.local/" title="局部连接层" class="md-nav__link">
      局部连接层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2.layers/5.recurrent/" title="循环层" class="md-nav__link">
      循环层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2.layers/6.embeddings/" title="嵌入层" class="md-nav__link">
      嵌入层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2.layers/7.merge/" title="融合层" class="md-nav__link">
      融合层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2.layers/8.advanced-activations/" title="高级激活层" class="md-nav__link">
      高级激活层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2.layers/9.normalization/" title="标准化层" class="md-nav__link">
      标准化层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2.layers/90.noise/" title="噪声层" class="md-nav__link">
      噪声层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2.layers/91.wrappers/" title="层封装器" class="md-nav__link">
      层封装器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2.layers/92.writing-your-own-keras-layers/" title="编写你自己的 Keras 层" class="md-nav__link">
      编写你自己的 Keras 层
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-21" type="checkbox" id="nav-21">
    
    <label class="md-nav__link" for="nav-21">
      3.preprocessing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-21">
        3.preprocessing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../3.preprocessing/0.sequence/" title="序列预处理" class="md-nav__link">
      序列预处理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../3.preprocessing/1.text/" title="文本预处理" class="md-nav__link">
      文本预处理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../3.preprocessing/2.image/" title="图像预处理" class="md-nav__link">
      图像预处理
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-22" type="checkbox" id="nav-22" checked>
    
    <label class="md-nav__link" for="nav-22">
      4.examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-22">
        4.examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="经典样例" class="md-nav__link">
      经典样例
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../addition_rnn/" title="实现一个用来执行加法的序列到序列学习模型" class="md-nav__link">
      实现一个用来执行加法的序列到序列学习模型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../antirectifier/" title="Antirectifier" class="md-nav__link">
      Antirectifier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../babi_memnn/" title="在 bAbI 数据集上训练一个记忆网络。" class="md-nav__link">
      在 bAbI 数据集上训练一个记忆网络。
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../babi_rnn/" title="基于故事和问题训练两个循环神经网络。" class="md-nav__link">
      基于故事和问题训练两个循环神经网络。
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cifar10_cnn/" title="在 CIFAR10 小型图像数据集上训练一个深度卷积神经网络。" class="md-nav__link">
      在 CIFAR10 小型图像数据集上训练一个深度卷积神经网络。
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cifar10_cnn_capsule/" title="在 CIFAR10 小型图像数据集上训练一个简单的 CNN-Capsule Network。" class="md-nav__link">
      在 CIFAR10 小型图像数据集上训练一个简单的 CNN-Capsule Network。
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cifar10_cnn_tfaugment2d/" title="Cifar10 cnn tfaugment2d" class="md-nav__link">
      Cifar10 cnn tfaugment2d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cifar10_resnet/" title="Cifar10 resnet" class="md-nav__link">
      Cifar10 resnet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../class_activation_maps/" title="Class activation maps" class="md-nav__link">
      Class activation maps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../conv_filter_visualization/" title="Conv filter visualization" class="md-nav__link">
      Conv filter visualization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../conv_lstm/" title="Conv lstm" class="md-nav__link">
      Conv lstm
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
    <a href="./" title="Deep dream" class="md-nav__link md-nav__link--active">
      Deep dream
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../image_ocr/" title="Optical character recognition" class="md-nav__link">
      Optical character recognition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../imdb_bidirectional_lstm/" title="Imdb bidirectional lstm" class="md-nav__link">
      Imdb bidirectional lstm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../imdb_cnn/" title="Imdb cnn" class="md-nav__link">
      Imdb cnn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../imdb_cnn_lstm/" title="Imdb cnn lstm" class="md-nav__link">
      Imdb cnn lstm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../imdb_fasttext/" title="Imdb fasttext" class="md-nav__link">
      Imdb fasttext
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../imdb_lstm/" title="Imdb lstm" class="md-nav__link">
      Imdb lstm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lstm_seq2seq/" title="Lstm seq2seq" class="md-nav__link">
      Lstm seq2seq
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lstm_seq2seq_restore/" title="Lstm seq2seq restore" class="md-nav__link">
      Lstm seq2seq restore
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lstm_stateful/" title="Lstm stateful" class="md-nav__link">
      Lstm stateful
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lstm_text_generation/" title="Lstm text generation" class="md-nav__link">
      Lstm text generation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mnist_acgan/" title="Mnist acgan" class="md-nav__link">
      Mnist acgan
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mnist_cnn/" title="Mnist cnn" class="md-nav__link">
      Mnist cnn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mnist_dataset_api/" title="Mnist dataset api" class="md-nav__link">
      Mnist dataset api
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mnist_denoising_autoencoder/" title="Mnist denoising autoencoder" class="md-nav__link">
      Mnist denoising autoencoder
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mnist_hierarchical_rnn/" title="Mnist hierarchical rnn" class="md-nav__link">
      Mnist hierarchical rnn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mnist_irnn/" title="Mnist irnn" class="md-nav__link">
      Mnist irnn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mnist_mlp/" title="Mnist mlp" class="md-nav__link">
      Mnist mlp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mnist_net2net/" title="Mnist net2net" class="md-nav__link">
      Mnist net2net
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mnist_siamese/" title="Mnist siamese" class="md-nav__link">
      Mnist siamese
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mnist_sklearn_wrapper/" title="Mnist sklearn wrapper" class="md-nav__link">
      Mnist sklearn wrapper
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mnist_swwae/" title="Mnist swwae" class="md-nav__link">
      Mnist swwae
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mnist_tfrecord/" title="Mnist tfrecord" class="md-nav__link">
      Mnist tfrecord
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mnist_transfer_cnn/" title="Mnist transfer cnn" class="md-nav__link">
      Mnist transfer cnn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../neural_doodle/" title="Neural doodle" class="md-nav__link">
      Neural doodle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../neural_style_transfer/" title="Neural style transfer" class="md-nav__link">
      Neural style transfer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pretrained_word_embeddings/" title="预训练的单词嵌入" class="md-nav__link">
      预训练的单词嵌入
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../reuters_mlp/" title="Reuters mlp" class="md-nav__link">
      Reuters mlp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../reuters_mlp_relu_vs_selu/" title="Reuters mlp relu vs selu" class="md-nav__link">
      Reuters mlp relu vs selu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tensorboard_embeddings_mnist/" title="Tensorboard embeddings mnist" class="md-nav__link">
      Tensorboard embeddings mnist
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../variational_autoencoder/" title="Variational autoencoder" class="md-nav__link">
      Variational autoencoder
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../variational_autoencoder_deconv/" title="Variational autoencoder deconv" class="md-nav__link">
      Variational autoencoder deconv
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/wohugb/keras-docs/edit/master/docs/4.examples/deep_dream.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Deep dream</h1>
                
                <p>Deep Dreaming in Keras.</p>
<p>Run the script with:</p>
<pre><code>python deep_dream.py path_to_your_base_image.jpg prefix_for_results
</code></pre>

<p>e.g.:</p>
<pre><code>python deep_dream.py img/mypic.jpg results/dream
</code></pre>

<pre><code class="python">from __future__ import print_function

from keras.preprocessing.image import load_img, save_img, img_to_array
import numpy as np
import scipy
import argparse

from keras.applications import inception_v3
from keras import backend as K

parser = argparse.ArgumentParser(description='Deep Dreams with Keras.')
parser.add_argument('base_image_path', metavar='base', type=str,
                    help='Path to the image to transform.')
parser.add_argument('result_prefix', metavar='res_prefix', type=str,
                    help='Prefix for the saved results.')

args = parser.parse_args()
base_image_path = args.base_image_path
result_prefix = args.result_prefix

# These are the names of the layers
# for which we try to maximize activation,
# as well as their weight in the final loss
# we try to maximize.
# You can tweak these setting to obtain new visual effects.
settings = {
    'features': {
        'mixed2': 0.2,
        'mixed3': 0.5,
        'mixed4': 2.,
        'mixed5': 1.5,
    },
}


def preprocess_image(image_path):
    # Util function to open, resize and format pictures
    # into appropriate tensors.
    img = load_img(image_path)
    img = img_to_array(img)
    img = np.expand_dims(img, axis=0)
    img = inception_v3.preprocess_input(img)
    return img


def deprocess_image(x):
    # Util function to convert a tensor into a valid image.
    if K.image_data_format() == 'channels_first':
        x = x.reshape((3, x.shape[2], x.shape[3]))
        x = x.transpose((1, 2, 0))
    else:
        x = x.reshape((x.shape[1], x.shape[2], 3))
    x /= 2.
    x += 0.5
    x *= 255.
    x = np.clip(x, 0, 255).astype('uint8')
    return x

K.set_learning_phase(0)

# Build the InceptionV3 network with our placeholder.
# The model will be loaded with pre-trained ImageNet weights.
model = inception_v3.InceptionV3(weights='imagenet',
                                 include_top=False)
dream = model.input
print('Model loaded.')

# Get the symbolic outputs of each &quot;key&quot; layer (we gave them unique names).
layer_dict = dict([(layer.name, layer) for layer in model.layers])

# Define the loss.
loss = K.variable(0.)
for layer_name in settings['features']:
    # Add the L2 norm of the features of a layer to the loss.
    if layer_name not in layer_dict:
        raise ValueError('Layer ' + layer_name + ' not found in model.')
    coeff = settings['features'][layer_name]
    x = layer_dict[layer_name].output
    # We avoid border artifacts by only involving non-border pixels in the loss.
    scaling = K.prod(K.cast(K.shape(x), 'float32'))
    if K.image_data_format() == 'channels_first':
        loss += coeff * K.sum(K.square(x[:, :, 2: -2, 2: -2])) / scaling
    else:
        loss += coeff * K.sum(K.square(x[:, 2: -2, 2: -2, :])) / scaling

# Compute the gradients of the dream wrt the loss.
grads = K.gradients(loss, dream)[0]
# Normalize gradients.
grads /= K.maximum(K.mean(K.abs(grads)), K.epsilon())

# Set up function to retrieve the value
# of the loss and gradients given an input image.
outputs = [loss, grads]
fetch_loss_and_grads = K.function([dream], outputs)


def eval_loss_and_grads(x):
    outs = fetch_loss_and_grads([x])
    loss_value = outs[0]
    grad_values = outs[1]
    return loss_value, grad_values


def resize_img(img, size):
    img = np.copy(img)
    if K.image_data_format() == 'channels_first':
        factors = (1, 1,
                   float(size[0]) / img.shape[2],
                   float(size[1]) / img.shape[3])
    else:
        factors = (1,
                   float(size[0]) / img.shape[1],
                   float(size[1]) / img.shape[2],
                   1)
    return scipy.ndimage.zoom(img, factors, order=1)


def gradient_ascent(x, iterations, step, max_loss=None):
    for i in range(iterations):
        loss_value, grad_values = eval_loss_and_grads(x)
        if max_loss is not None and loss_value &gt; max_loss:
            break
        print('..Loss value at', i, ':', loss_value)
        x += step * grad_values
    return x


&quot;&quot;&quot;Process:

- Load the original image.
- Define a number of processing scales (i.e. image shapes),
    from smallest to largest.
- Resize the original image to the smallest scale.
- For every scale, starting with the smallest (i.e. current one):
    - Run gradient ascent
    - Upscale image to the next scale
    - Reinject the detail that was lost at upscaling time
- Stop when we are back to the original size.

To obtain the detail lost during upscaling, we simply
take the original image, shrink it down, upscale it,
and compare the result to the (resized) original image.
&quot;&quot;&quot;


# Playing with these hyperparameters will also allow you to achieve new effects
step = 0.01  # Gradient ascent step size
num_octave = 3  # Number of scales at which to run gradient ascent
octave_scale = 1.4  # Size ratio between scales
iterations = 20  # Number of ascent steps per scale
max_loss = 10.

img = preprocess_image(base_image_path)
if K.image_data_format() == 'channels_first':
    original_shape = img.shape[2:]
else:
    original_shape = img.shape[1:3]
successive_shapes = [original_shape]
for i in range(1, num_octave):
    shape = tuple([int(dim / (octave_scale ** i)) for dim in original_shape])
    successive_shapes.append(shape)
successive_shapes = successive_shapes[::-1]
original_img = np.copy(img)
shrunk_original_img = resize_img(img, successive_shapes[0])

for shape in successive_shapes:
    print('Processing image shape', shape)
    img = resize_img(img, shape)
    img = gradient_ascent(img,
                          iterations=iterations,
                          step=step,
                          max_loss=max_loss)
    upscaled_shrunk_original_img = resize_img(shrunk_original_img, shape)
    same_size_original = resize_img(original_img, shape)
    lost_detail = same_size_original - upscaled_shrunk_original_img

    img += lost_detail
    shrunk_original_img = resize_img(original_img, shape)

save_img(result_prefix + '.png', deprocess_image(np.copy(img)))
</code></pre>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../conv_lstm/" title="Conv lstm" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  后退
                </span>
                Conv lstm
              </span>
            </div>
          </a>
        
        
          <a href="../image_ocr/" title="Optical character recognition" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前进
                </span>
                Optical character recognition
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="http://wohugb.github.io" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/wohugb" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/wohugb" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://linkedin.com/in/wohugb" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.2ba8dec4.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../../assets/javascripts/lunr/lunr.ja.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>